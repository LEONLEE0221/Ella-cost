<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IL-22 æ£€æµ‹æˆæœ¬å¯¹æ¯”è®¡ç®—å™¨ | R&D vs Ella</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
        }

        @media (max-width: 1024px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }
        }

        .input-section {
            padding: 30px;
            background: #f8f9fa;
            border-right: 1px solid #e0e0e0;
        }

        .result-section {
            padding: 30px;
            background: white;
        }

        .section-title {
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title .icon {
            font-size: 24px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .input-group .hint {
            font-size: 12px;
            color: #888;
            margin-top: 4px;
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        input[type="number"],
        input[type="text"],
        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        input[readonly] {
            background: #f0f0f0;
            cursor: not-allowed;
        }

        .method-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }

        .method-card.active {
            border-color: #3498db;
            box-shadow: 0 5px 20px rgba(52, 152, 219, 0.15);
        }

        .method-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .method-card .method-badge {
            background: #3498db;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .result-card h3 {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .result-card .value {
            font-size: 32px;
            font-weight: 700;
        }

        .result-card .unit {
            font-size: 14px;
            opacity: 0.8;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .comparison-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .comparison-table tr:hover {
            background: #f8f9fa;
        }

        .highlight {
            background: #e8f4fd !important;
            font-weight: 600;
        }

        .best-value {
            color: #27ae60;
            font-weight: 700;
        }

        .bar-chart {
            margin: 20px 0;
        }

        .bar-item {
            margin-bottom: 15px;
        }

        .bar-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
            color: #555;
        }

        .bar-container {
            background: #e0e0e0;
            border-radius: 10px;
            height: 30px;
            overflow: hidden;
        }

        .bar-fill {
            height: 100%;
            border-radius: 10px;
            display: flex;
            align-items: center;
            padding-left: 15px;
            color: white;
            font-weight: 600;
            font-size: 13px;
            transition: width 0.5s ease;
        }

        .bar-rd {
            background: linear-gradient(90deg, #3498db, #2980b9);
        }

        .bar-ella {
            background: linear-gradient(90deg, #e74c3c, #c0392b);
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(52, 152, 219, 0.4);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #555;
            border: 2px solid #e0e0e0;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 13px;
        }

        .tab.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .savings-badge {
            background: #27ae60;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 13px;
            color: #856404;
        }

        .info-box {
            background: #d1ecf1;
            border: 1px solid #17a2b8;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 13px;
            color: #0c5460;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        @media (max-width: 768px) {
            .grid-3 {
                grid-template-columns: 1fr;
            }
            .input-row {
                grid-template-columns: 1fr;
            }
        }

        .print-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #2c3e50;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 1000;
        }

        .print-btn:hover {
            transform: scale(1.1);
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
            }
            .print-btn {
                display: none;
            }
            .input-section {
                display: none;
            }
            .calculator-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§ª IL-22 æ£€æµ‹æˆæœ¬å¯¹æ¯”è®¡ç®—å™¨</h1>
            <p>R&D Systems DuoSet ELISA vs ProteinSimple Ella Cartridge | ä¸å«ä»ªå™¨æŠ˜æ—§</p>
        </div>

        <div class="calculator-grid">
            <!-- è¾“å…¥åŒºåŸŸ -->
            <div class="input-section">
                <h2 class="section-title">
                    <span class="icon">âš™ï¸</span>
                    å‚æ•°è®¾ç½®
                </h2>

                <!-- äººå·¥æˆæœ¬ -->
                <div class="method-card active">
                    <h3>ğŸ’° äººå·¥æˆæœ¬ <span class="method-badge">åŸºç¡€å‚æ•°</span></h3>
                    <div class="input-row">
                        <div class="input-group">
                            <label>æœˆè–ª (HKD)</label>
                            <input type="number" id="monthlySalary" value="22000" onchange="calculate()">
                            <div class="hint">æŠ€æœ¯äººå‘˜æœˆè–ª</div>
                        </div>
                        <div class="input-group">
                            <label>æ¯æœˆå·¥ä½œå¤©æ•°</label>
                            <input type="number" id="workDaysPerMonth" value="22" onchange="calculate()">
                            <div class="hint">é€šå¸¸22å¤©</div>
                        </div>
                    </div>
                    <div class="input-row">
                        <div class="input-group">
                            <label>æ¯æ—¥å·¥ä½œå°æ—¶</label>
                            <input type="number" id="hoursPerDay" value="8" onchange="calculate()">
                            <div class="hint">æ ‡å‡†8å°æ—¶</div>
                        </div>
                        <div class="input-group">
                            <label>æ—¶è–ª (HKD)</label>
                            <input type="number" id="hourlyRate" value="125" readonly>
                            <div class="hint">è‡ªåŠ¨è®¡ç®—</div>
                        </div>
                    </div>
                </div>

                <!-- R&D å‚æ•° -->
                <div class="method-card">
                    <h3>ğŸ”¬ R&D DuoSet ELISA <span class="method-badge">ä¼ ç»Ÿæ–¹æ³•</span></h3>
                    <div class="input-row">
                        <div class="input-group">
                            <label>è¯•å‰‚ç›’ä»·æ ¼ (HKD)</label>
                            <input type="number" id="rdKitPrice" value="5400" onchange="calculate()">
                            <div class="hint">5æ¿è£…æ€»ä»·</div>
                        </div>
                        <div class="input-group">
                            <label>è¯•å‰‚ç›’æ¿æ•°</label>
                            <input type="number" id="rdKitPlates" value="5" onchange="calculate()">
                            <div class="hint">é€šå¸¸5æ¿</div>
                        </div>
                    </div>
                    <div class="input-row">
                        <div class="input-group">
                            <label>æ¯æ¿å­”æ•°</label>
                            <input type="number" id="rdWellsPerPlate" value="96" onchange="calculate()">
                            <div class="hint">æ ‡å‡†96å­”</div>
                        </div>
                        <div class="input-group">
                            <label>æ ‡å‡†æ›²çº¿å ç”¨å­”</label>
                            <input type="number" id="rdStandardWells" value="8" onchange="calculate()">
                            <div class="hint">é€šå¸¸8å­”</div>
                        </div>
                    </div>
                    <div class="input-row">
                        <div class="input-group">
                            <label>é‡å¤æ¬¡æ•°</label>
                            <select id="rdReplicates" onchange="calculate()">
                                <option value="2">2æ¬¡é‡å¤</option>
                                <option value="3" selected>3æ¬¡é‡å¤</option>
                                <option value="4">4æ¬¡é‡å¤</option>
                            </select>
                            <div class="hint">å½±å“æ¯æ¿æ ·æœ¬æ•°</div>
                        </div>
                        <div class="input-group">
                            <label>æ£€æµ‹æ—¶é—´ (å°æ—¶/æ‰¹æ¬¡)</label>
                            <input type="number" id="rdTimePerBatch" value="4" step="0.5" onchange="calculate()">
                            <div class="hint">4-6å°æ—¶</div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>è€—ææˆæœ¬/æ¿ (HKD)</label>
                        <input type="number" id="rdConsumablePerPlate" value="35" onchange="calculate()">
                        <div class="hint">é…¶æ ‡æ¿ã€æ´—æ¶²ç­‰</div>
                    </div>
                </div>

                <!-- Ella å‚æ•° -->
                <div class="method-card">
                    <h3>ğŸ¤– Ella IL-22 Cartridge <span class="method-badge">è‡ªåŠ¨åŒ–</span></h3>
                    <div class="input-row">
                        <div class="input-group">
                            <label>Cartridgeä»·æ ¼ (HKD)</label>
                            <input type="number" id="ellaCartridgePrice" value="10680" onchange="calculate()">
                            <div class="hint">å•å¡ä»·æ ¼</div>
                        </div>
                        <div class="input-group">
                            <label>æ¯å¡æ ·æœ¬æ•°</label>
                            <input type="number" id="ellaSamplesPerCartridge" value="72" onchange="calculate()">
                            <div class="hint">å·²å«3æ¬¡é‡å¤</div>
                        </div>
                    </div>
                    <div class="input-row">
                        <div class="input-group">
                            <label>å†…ç½®é‡å¤æ¬¡æ•°</label>
                            <input type="number" id="ellaReplicates" value="3" readonly>
                            <div class="hint">å›ºå®š3æ¬¡</div>
                        </div>
                        <div class="input-group">
                            <label>æ£€æµ‹æ—¶é—´ (å°æ—¶/å¡)</label>
                            <input type="number" id="ellaTimePerCartridge" value="1.5" step="0.5" onchange="calculate()">
                            <div class="hint">çº¦90åˆ†é’Ÿ</div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>è€—ææˆæœ¬/å¡ (HKD)</label>
                        <input type="number" id="ellaConsumablePerCartridge" value="0" onchange="calculate()">
                        <div class="hint">é€šå¸¸å·²åŒ…å«</div>
                    </div>
                </div>

                <!-- æ ·æœ¬é‡è®¾ç½® -->
                <div class="method-card">
                    <h3>ğŸ“Š æ£€æµ‹è§„æ¨¡ <span class="method-badge">å¯å˜å‚æ•°</span></h3>
                    <div class="input-row">
                        <div class="input-group">
                            <label>æ€»æ ·æœ¬æ•°é‡</label>
                            <input type="number" id="totalSamples" value="200" onchange="calculate()">
                            <div class="hint">éœ€è¦æ£€æµ‹çš„æ ·æœ¬æ€»æ•°</div>
                        </div>
                        <div class="input-group">
                            <label>æ£€æµ‹é¢‘ç‡</label>
                            <select id="testFrequency" onchange="calculate()">
                                <option value="52">æ¯å‘¨1æ¬¡ (52æ¬¡/å¹´)</option>
                                <option value="26">æ¯2å‘¨1æ¬¡ (26æ¬¡/å¹´)</option>
                                <option value="12" selected>æ¯æœˆ1æ¬¡ (12æ¬¡/å¹´)</option>
                                <option value="4">æ¯å­£åº¦1æ¬¡ (4æ¬¡/å¹´)</option>
                            </select>
                            <div class="hint">ç”¨äºå¹´åº¦æˆæœ¬è®¡ç®—</div>
                        </div>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="calculate()">ğŸ”„ é‡æ–°è®¡ç®—</button>
                    <button class="btn btn-secondary" onclick="resetDefaults()">â†©ï¸ æ¢å¤é»˜è®¤</button>
                </div>

                <div class="info-box">
                    ğŸ’¡ <strong>æç¤ºï¼š</strong> æ‰€æœ‰è¾“å…¥æ¡†éƒ½å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ï¼Œä¿®æ”¹åè‡ªåŠ¨æ›´æ–°ç»“æœã€‚ç°è‰²æ¡†ä¸ºè‡ªåŠ¨è®¡ç®—å€¼ã€‚<br>
                    âš ï¸ <strong>æ³¨æ„ï¼š</strong> æœ¬è®¡ç®—å™¨ä¸åŒ…å«ä»ªå™¨æŠ˜æ—§æˆæœ¬ï¼Œä»…è®¡ç®—è¯•å‰‚ã€äººå·¥å’Œè€—ææˆæœ¬ã€‚
                </div>
            </div>

            <!-- ç»“æœåŒºåŸŸ -->
            <div class="result-section">
                <h2 class="section-title">
                    <span class="icon">ğŸ“ˆ</span>
                    æˆæœ¬å¯¹æ¯”ç»“æœ
                </h2>

                <!-- æ ¸å¿ƒç»“æœ -->
                <div class="grid-3">
                    <div class="result-card" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                        <h3>R&D æ¯æ ·æœ¬æˆæœ¬</h3>
                        <div class="value" id="rdCostPerSample">0</div>
                        <div class="unit">HKD/æ ·æœ¬</div>
                    </div>
                    <div class="result-card" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                        <h3>Ella æ¯æ ·æœ¬æˆæœ¬</h3>
                        <div class="value" id="ellaCostPerSample">0</div>
                        <div class="unit">HKD/æ ·æœ¬</div>
                    </div>
                    <div class="result-card" style="background: linear-gradient(135deg, #27ae60, #229954);">
                        <h3>æˆæœ¬èŠ‚çœ</h3>
                        <div class="value" id="savingsPercent">0</div>
                        <div class="unit">R&D èŠ‚çœæ¯”ä¾‹</div>
                    </div>
                </div>

                <!-- æ ‡ç­¾é¡µ -->
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('detail')">ğŸ“‹ è¯¦ç»†å¯¹æ¯”</div>
                    <div class="tab" onclick="switchTab('breakdown')">ğŸ’µ æˆæœ¬åˆ†è§£</div>
                    <div class="tab" onclick="switchTab('annual')">ğŸ“… å¹´åº¦æˆæœ¬</div>
                    <div class="tab" onclick="switchTab('chart')">ğŸ“Š å¯è§†åŒ–</div>
                </div>

                <!-- è¯¦ç»†å¯¹æ¯” -->
                <div class="tab-content active" id="tab-detail">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>å¯¹æ¯”é¡¹ç›®</th>
                                <th>R&D DuoSet ELISA</th>
                                <th>Ella Cartridge</th>
                                <th>ä¼˜åŠ¿æ–¹</th>
                            </tr>
                        </thead>
                        <tbody id="detailTableBody">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </tbody>
                    </table>
                </div>

                <!-- æˆæœ¬åˆ†è§£ -->
                <div class="tab-content" id="tab-breakdown">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>æˆæœ¬é¡¹ç›®</th>
                                <th>R&D (HKD/æ ·æœ¬)</th>
                                <th>Ella (HKD/æ ·æœ¬)</th>
                                <th>å·®å¼‚</th>
                            </tr>
                        </thead>
                        <tbody id="breakdownTableBody">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </tbody>
                    </table>
                </div>

                <!-- å¹´åº¦æˆæœ¬ -->
                <div class="tab-content" id="tab-annual">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>æ£€æµ‹é¢‘ç‡</th>
                                <th>å¹´æ ·æœ¬é‡</th>
                                <th>R&Då¹´æˆæœ¬</th>
                                <th>Ellaå¹´æˆæœ¬</th>
                                <th>èŠ‚çœé‡‘é¢</th>
                            </tr>
                        </thead>
                        <tbody id="annualTableBody">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </tbody>
                    </table>
                </div>

                <!-- å¯è§†åŒ–å›¾è¡¨ -->
                <div class="tab-content" id="tab-chart">
                    <div class="bar-chart">
                        <h4 style="margin-bottom: 20px; color: #2c3e50;">æ¯æ ·æœ¬æ€»æˆæœ¬å¯¹æ¯”</h4>
                        
                        <div class="bar-item">
                            <div class="bar-label">
                                <span>R&D DuoSet ELISA</span>
                                <span id="barRdValue">0 HKD</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar-fill bar-rd" id="barRd" style="width: 0%;">0</div>
                            </div>
                        </div>

                        <div class="bar-item">
                            <div class="bar-label">
                                <span>Ella Cartridge</span>
                                <span id="barEllaValue">0 HKD</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar-fill bar-ella" id="barElla" style="width: 0%;">0</div>
                            </div>
                        </div>
                    </div>

                    <div class="bar-chart">
                        <h4 style="margin-bottom: 20px; color: #2c3e50;">æˆæœ¬æ„æˆåˆ†è§£</h4>
                        
                        <div class="bar-item">
                            <div class="bar-label">
                                <span>R&D - è¯•å‰‚æˆæœ¬</span>
                                <span id="rdReagentValue">0 HKD</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar-fill bar-rd" id="rdReagentBar" style="width: 0%;">0</div>
                            </div>
                        </div>

                        <div class="bar-item">
                            <div class="bar-label">
                                <span>R&D - äººå·¥æˆæœ¬</span>
                                <span id="rdLaborValue">0 HKD</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar-fill bar-rd" id="rdLaborBar" style="width: 0%; background: linear-gradient(90deg, #f39c12, #e67e22);">0</div>
                            </div>
                        </div>

                        <div class="bar-item">
                            <div class="bar-label">
                                <span>Ella - è¯•å‰‚æˆæœ¬</span>
                                <span id="ellaReagentValue">0 HKD</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar-fill bar-ella" id="ellaReagentBar" style="width: 0%;">0</div>
                            </div>
                        </div>

                        <div class="bar-item">
                            <div class="bar-label">
                                <span>Ella - äººå·¥æˆæœ¬</span>
                                <span id="ellaLaborValue">0 HKD</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar-fill bar-ella" id="ellaLaborBar" style="width: 0%; background: linear-gradient(90deg, #f39c12, #e67e22);">0</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ€»æˆæœ¬å¯¹æ¯” -->
                <div class="method-card" style="margin-top: 20px;">
                    <h3>ğŸ“¦ å½“å‰æ ·æœ¬é‡æ€»æˆæœ¬ (<span id="currentSampleCount">200</span> æ ·æœ¬)</h3>
                    <div class="grid-3" style="margin-top: 15px;">
                        <div style="text-align: center; padding: 15px; background: #e8f4fd; border-radius: 8px;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 5px;">R&D æ€»æˆæœ¬</div>
                            <div style="font-size: 24px; font-weight: 700; color: #3498db;" id="rdTotalCost">0 HKD</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #fde8e8; border-radius: 8px;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 5px;">Ella æ€»æˆæœ¬</div>
                            <div style="font-size: 24px; font-weight: 700; color: #e74c3c;" id="ellaTotalCost">0 HKD</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #e8fde8; border-radius: 8px;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 5px;">èŠ‚çœé‡‘é¢</div>
                            <div style="font-size: 24px; font-weight: 700; color: #27ae60;" id="totalSavings">0 HKD</div>
                        </div>
                    </div>
                </div>

                <!-- å»ºè®® -->
                <div class="warning-box">
                    <strong>ğŸ’¡ æ™ºèƒ½å»ºè®®ï¼š</strong> <span id="recommendation">è®¡ç®—åå°†æ˜¾ç¤ºæ¨èæ–¹æ¡ˆ</span>
                </div>
            </div>
        </div>
    </div>

    <button class="print-btn" onclick="window.print()" title="æ‰“å°æŠ¥å‘Š">ğŸ–¨ï¸</button>

    <script>
        // é»˜è®¤å€¼å­˜å‚¨
        const defaults = {
            monthlySalary: 22000,
            workDaysPerMonth: 22,
            hoursPerDay: 8,
            rdKitPrice: 5400,
            rdKitPlates: 5,
            rdWellsPerPlate: 96,
            rdStandardWells: 8,
            rdReplicates: 3,
            rdTimePerBatch: 4,
            rdConsumablePerPlate: 35,
            ellaCartridgePrice: 10680,
            ellaSamplesPerCartridge: 72,
            ellaReplicates: 3,
            ellaTimePerCartridge: 1.5,
            ellaConsumablePerCartridge: 0,
            totalSamples: 200,
            testFrequency: 12
        };

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            calculate();
        });

        // è®¡ç®—ä¸»å‡½æ•°
        function calculate() {
            // è·å–è¾“å…¥å€¼
            const monthlySalary = parseFloat(document.getElementById('monthlySalary').value) || 0;
            const workDaysPerMonth = parseFloat(document.getElementById('workDaysPerMonth').value) || 0;
            const hoursPerDay = parseFloat(document.getElementById('hoursPerDay').value) || 0;
            
            // è®¡ç®—æ—¶è–ª
            const hourlyRate = monthlySalary / workDaysPerMonth / hoursPerDay;
            document.getElementById('hourlyRate').value = hourlyRate.toFixed(2);

            // R&D å‚æ•°
            const rdKitPrice = parseFloat(document.getElementById('rdKitPrice').value) || 0;
            const rdKitPlates = parseFloat(document.getElementById('rdKitPlates').value) || 0;
            const rdWellsPerPlate = parseFloat(document.getElementById('rdWellsPerPlate').value) || 0;
            const rdStandardWells = parseFloat(document.getElementById('rdStandardWells').value) || 0;
            const rdReplicates = parseFloat(document.getElementById('rdReplicates').value) || 2;
            const rdTimePerBatch = parseFloat(document.getElementById('rdTimePerBatch').value) || 4;
            const rdConsumablePerPlate = parseFloat(document.getElementById('rdConsumablePerPlate').value) || 0;

            // Ella å‚æ•°
            const ellaCartridgePrice = parseFloat(document.getElementById('ellaCartridgePrice').value) || 0;
            const ellaSamplesPerCartridge = parseFloat(document.getElementById('ellaSamplesPerCartridge').value) || 0;
            const ellaTimePerCartridge = parseFloat(document.getElementById('ellaTimePerCartridge').value) || 1.5;
            const ellaConsumablePerCartridge = parseFloat(document.getElementById('ellaConsumablePerCartridge').value) || 0;

            // æ ·æœ¬é‡å‚æ•°
            const totalSamples = parseFloat(document.getElementById('totalSamples').value) || 0;
            const testFrequency = parseFloat(document.getElementById('testFrequency').value) || 12;

            // R&D è®¡ç®—
            const rdEffectiveWells = rdWellsPerPlate - rdStandardWells;
            const rdSamplesPerPlate = Math.floor(rdEffectiveWells / rdReplicates);
            const rdTotalPlates = Math.ceil(totalSamples / rdSamplesPerPlate);
            const rdBatches = rdTotalPlates;
            
            // R&D æˆæœ¬åˆ†è§£ï¼ˆä¸å«æŠ˜æ—§ï¼‰
            const rdReagentCostPerSample = (rdKitPrice / rdKitPlates) / rdSamplesPerPlate;
            const rdLaborCostPerSample = (rdTimePerBatch * hourlyRate) / rdSamplesPerPlate;
            const rdConsumablePerSample = rdConsumablePerPlate / rdSamplesPerPlate;
            const rdTotalPerSample = rdReagentCostPerSample + rdLaborCostPerSample + rdConsumablePerSample;

            // Ella è®¡ç®—
            const ellaTotalCartridges = Math.ceil(totalSamples / ellaSamplesPerCartridge);
            const ellaBatches = ellaTotalCartridges;
            
            // Ella æˆæœ¬åˆ†è§£ï¼ˆä¸å«æŠ˜æ—§ï¼‰
            const ellaReagentCostPerSample = ellaCartridgePrice / ellaSamplesPerCartridge;
            const ellaLaborCostPerSample = (ellaTimePerCartridge * hourlyRate) / ellaSamplesPerCartridge;
            const ellaConsumablePerSample = ellaConsumablePerCartridge / ellaSamplesPerCartridge;
            const ellaTotalPerSample = ellaReagentCostPerSample + ellaLaborCostPerSample + ellaConsumablePerSample;

            // æ€»æˆæœ¬
            const rdTotalCost = rdTotalPerSample * totalSamples;
            const ellaTotalCost = ellaTotalPerSample * totalSamples;
            const savings = ellaTotalCost - rdTotalCost;
            const savingsPercent = ellaTotalPerSample > 0 ? ((ellaTotalPerSample - rdTotalPerSample) / ellaTotalPerSample * 100).toFixed(1) : 0;

            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('rdCostPerSample').textContent = rdTotalPerSample.toFixed(2);
            document.getElementById('ellaCostPerSample').textContent = ellaTotalPerSample.toFixed(2);
            document.getElementById('savingsPercent').textContent = savingsPercent + '%';
            document.getElementById('currentSampleCount').textContent = totalSamples;
            document.getElementById('rdTotalCost').textContent = formatCurrency(rdTotalCost);
            document.getElementById('ellaTotalCost').textContent = formatCurrency(ellaTotalCost);
            document.getElementById('totalSavings').textContent = formatCurrency(savings);

            // æ›´æ–°è¯¦ç»†å¯¹æ¯”è¡¨
            updateDetailTable(rdSamplesPerPlate, ellaSamplesPerCartridge, rdReplicates, rdTimePerBatch, ellaTimePerCartridge, rdTotalPerSample, ellaTotalPerSample);

            // æ›´æ–°æˆæœ¬åˆ†è§£è¡¨
            updateBreakdownTable(rdReagentCostPerSample, rdLaborCostPerSample, rdConsumablePerSample,
                                ellaReagentCostPerSample, ellaLaborCostPerSample, ellaConsumablePerSample);

            // æ›´æ–°å¹´åº¦æˆæœ¬è¡¨
            updateAnnualTable(rdTotalPerSample, ellaTotalPerSample, testFrequency, totalSamples);

            // æ›´æ–°å›¾è¡¨
            updateCharts(rdTotalPerSample, ellaTotalPerSample, rdReagentCostPerSample, rdLaborCostPerSample, 
                        ellaReagentCostPerSample, ellaLaborCostPerSample);

            // æ›´æ–°å»ºè®®
            updateRecommendation(rdTotalPerSample, ellaTotalPerSample, totalSamples, rdReplicates);
        }

        function formatCurrency(value) {
            return value.toLocaleString('en-HK', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) + ' HKD';
        }

        function updateDetailTable(rdSamplesPerPlate, ellaSamplesPerCartridge, rdReplicates, rdTime, ellaTime, rdCost, ellaCost) {
            const tbody = document.getElementById('detailTableBody');
            const rdBetter = rdCost < ellaCost;
            
            tbody.innerHTML = `
                <tr>
                    <td>æ¯æ¿/å¡æœ‰æ•ˆæ ·æœ¬æ•°</td>
                    <td>${rdSamplesPerPlate} æ ·æœ¬/æ¿</td>
                    <td>${ellaSamplesPerCartridge} æ ·æœ¬/å¡</td>
                    <td>${rdSamplesPerPlate > ellaSamplesPerCartridge ? '<span class="best-value">âœ“ R&D</span>' : '<span class="best-value">âœ“ Ella</span>'}</td>
                </tr>
                <tr>
                    <td>é‡å¤æ¬¡æ•°</td>
                    <td>${rdReplicates} æ¬¡</td>
                    <td>3 æ¬¡ (å†…ç½®)</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>æ£€æµ‹æ—¶é—´/æ‰¹æ¬¡</td>
                    <td>${rdTime} å°æ—¶</td>
                    <td>${ellaTime} å°æ—¶</td>
                    <td>${rdTime > ellaTime ? '<span class="best-value">âœ“ Ella</span>' : '<span class="best-value">âœ“ R&D</span>'}</td>
                </tr>
                <tr class="highlight">
                    <td><strong>æ¯æ ·æœ¬æ€»æˆæœ¬</strong></td>
                    <td class="${rdBetter ? 'highlight' : ''}"><strong>${rdCost.toFixed(2)} HKD</strong></td>
                    <td class="${!rdBetter ? 'highlight' : ''}"><strong>${ellaCost.toFixed(2)} HKD</strong></td>
                    <td>${rdBetter ? '<span class="best-value">âœ“ R&D</span>' : '<span class="best-value">âœ“ Ella</span>'}</td>
                </tr>
                <tr>
                    <td>çµæ•åº¦</td>
                    <td>15.6 pg/mL</td>
                    <td>0.5-2 pg/mL</td>
                    <td><span class="best-value">âœ“ Ella</span></td>
                </tr>
                <tr>
                    <td>é‡å¤æ€§ (CV)</td>
                    <td>10-15%</td>
                    <td>&lt;5%</td>
                    <td><span class="best-value">âœ“ Ella</span></td>
                </tr>
                <tr>
                    <td>æ ·æœ¬ç”¨é‡</td>
                    <td>100 ÂµL</td>
                    <td>25 ÂµL</td>
                    <td><span class="best-value">âœ“ Ella</span></td>
                </tr>
            `;
        }

        function updateBreakdownTable(rdReagent, rdLabor, rdConsumable, ellaReagent, ellaLabor, ellaConsumable) {
            const tbody = document.getElementById('breakdownTableBody');
            const rdTotal = rdReagent + rdLabor + rdConsumable;
            const ellaTotal = ellaReagent + ellaLabor + ellaConsumable;
            
            tbody.innerHTML = `
                <tr class="highlight">
                    <td><strong>è¯•å‰‚æˆæœ¬</strong></td>
                    <td>${rdReagent.toFixed(2)}</td>
                    <td>${ellaReagent.toFixed(2)}</td>
                    <td class="${rdReagent < ellaReagent ? 'best-value' : ''}">${rdReagent < ellaReagent ? 'âœ“ R&D çœ' + formatCurrency(ellaReagent - rdReagent) : 'âœ“ Ella çœ' + formatCurrency(rdReagent - ellaReagent)}</td>
                </tr>
                <tr>
                    <td>äººå·¥æˆæœ¬</td>
                    <td>${rdLabor.toFixed(2)}</td>
                    <td>${ellaLabor.toFixed(2)}</td>
                    <td class="${rdLabor > ellaLabor ? 'best-value' : ''}">${rdLabor > ellaLabor ? 'âœ“ Ella çœ' + formatCurrency(rdLabor - ellaLabor) : 'âœ“ R&D çœ' + formatCurrency(ellaLabor - rdLabor)}</td>
                </tr>
                <tr>
                    <td>è€—ææˆæœ¬</td>
                    <td>${rdConsumable.toFixed(2)}</td>
                    <td>${ellaConsumable.toFixed(2)}</td>
                    <td class="${rdConsumable > ellaConsumable ? 'best-value' : ''}">${rdConsumable > ellaConsumable ? 'âœ“ Ella' : 'âœ“ R&D'}</td>
                </tr>
                <tr style="background: #f0f0f0; font-weight: 700;">
                    <td>æ€»è®¡</td>
                    <td>${rdTotal.toFixed(2)}</td>
                    <td>${ellaTotal.toFixed(2)}</td>
                    <td class="best-value">R&D çœ ${formatCurrency(ellaTotal - rdTotal)}</td>
                </tr>
            `;
        }

        function updateAnnualTable(rdPerSample, ellaPerSample, frequency, baseSamples) {
            const tbody = document.getElementById('annualTableBody');
            const frequencies = [
                { label: 'æ¯å‘¨1æ¬¡', value: 52 },
                { label: 'æ¯2å‘¨1æ¬¡', value: 26 },
                { label: 'æ¯æœˆ1æ¬¡', value: 12 },
                { label: 'æ¯å­£åº¦1æ¬¡', value: 4 }
            ];
            
            tbody.innerHTML = frequencies.map(f => {
                const annualSamples = baseSamples * (f.value / frequency);
                const rdAnnual = rdPerSample * annualSamples;
                const ellaAnnual = ellaPerSample * annualSamples;
                const savings = ellaAnnual - rdAnnual;
                const savingsPercent = ellaPerSample > 0 ? ((ellaPerSample - rdPerSample) / ellaPerSample * 100).toFixed(1) : 0;
                
                return `
                    <tr>
                        <td>${f.label}</td>
                        <td>${Math.round(annualSamples)}</td>
                        <td>${formatCurrency(rdAnnual)}</td>
                        <td>${formatCurrency(ellaAnnual)}</td>
                        <td class="best-value">${formatCurrency(savings)} (${savingsPercent}%)</td>
                    </tr>
                `;
            }).join('');
        }

        function updateCharts(rdTotal, ellaTotal, rdReagent, rdLabor, ellaReagent, ellaLabor) {
            const maxCost = Math.max(rdTotal, ellaTotal);
            
            // æ€»æˆæœ¬æ¡å½¢å›¾
            const rdPercent = maxCost > 0 ? (rdTotal / maxCost * 100).toFixed(1) : 0;
            const ellaPercent = maxCost > 0 ? (ellaTotal / maxCost * 100).toFixed(1) : 0;
            
            document.getElementById('barRd').style.width = rdPercent + '%';
            document.getElementById('barRd').textContent = rdTotal.toFixed(2) + ' HKD';
            document.getElementById('barRdValue').textContent = rdTotal.toFixed(2) + ' HKD';
            
            document.getElementById('barElla').style.width = ellaPercent + '%';
            document.getElementById('barElla').textContent = ellaTotal.toFixed(2) + ' HKD';
            document.getElementById('barEllaValue').textContent = ellaTotal.toFixed(2) + ' HKD';

            // æˆæœ¬åˆ†è§£æ¡å½¢å›¾
            const maxReagent = Math.max(rdReagent, ellaReagent);
            const rdReagentPercent = maxReagent > 0 ? (rdReagent / maxReagent * 100).toFixed(1) : 0;
            const ellaReagentPercent = maxReagent > 0 ? (ellaReagent / maxReagent * 100).toFixed(1) : 0;
            
            document.getElementById('rdReagentBar').style.width = rdReagentPercent + '%';
            document.getElementById('rdReagentBar').textContent = rdReagent.toFixed(2);
            document.getElementById('rdReagentValue').textContent = rdReagent.toFixed(2) + ' HKD';
            
            document.getElementById('ellaReagentBar').style.width = ellaReagentPercent + '%';
            document.getElementById('ellaReagentBar').textContent = ellaReagent.toFixed(2);
            document.getElementById('ellaReagentValue').textContent = ellaReagent.toFixed(2) + ' HKD';

            const maxLabor = Math.max(rdLabor, ellaLabor);
            const rdLaborPercent = maxLabor > 0 ? (rdLabor / maxLabor * 100).toFixed(1) : 0;
            const ellaLaborPercent = maxLabor > 0 ? (ellaLabor / maxLabor * 100).toFixed(1) : 0;
            
            document.getElementById('rdLaborBar').style.width = rdLaborPercent + '%';
            document.getElementById('rdLaborBar').textContent = rdLabor.toFixed(2);
            document.getElementById('rdLaborValue').textContent = rdLabor.toFixed(2) + ' HKD';
            
            document.getElementById('ellaLaborBar').style.width = ellaLaborPercent + '%';
            document.getElementById('ellaLaborBar').textContent = ellaLabor.toFixed(2);
            document.getElementById('ellaLaborValue').textContent = ellaLabor.toFixed(2) + ' HKD';
        }

        function updateRecommendation(rdCost, ellaCost, samples, replicates) {
            const rec = document.getElementById('recommendation');
            const savings = ellaCost > 0 ? ((ellaCost - rdCost) / ellaCost * 100).toFixed(1) : 0;
            
            if (rdCost < ellaCost) {
                if (samples > 100) {
                    rec.innerHTML = `åŸºäºå½“å‰å‚æ•°ï¼Œ<strong>R&D DuoSet ELISA (${replicates}æ¬¡é‡å¤)</strong> æ›´å…·æˆæœ¬æ•ˆç›Šï¼Œæ¯æ ·æœ¬å¯èŠ‚çœ <span class="savings-badge">${savings}%</span>ã€‚é€‚åˆå¤§æ ·æœ¬é‡å¸¸è§„æ£€æµ‹ã€‚`;
                } else {
                    rec.innerHTML = `åŸºäºå½“å‰å‚æ•°ï¼Œ<strong>R&D DuoSet ELISA</strong> æˆæœ¬æ›´ä½ï¼Œä½†å¦‚æœæ‚¨éœ€è¦æ›´é«˜çµæ•åº¦æˆ–æ ·æœ¬æå…¶çè´µï¼Œå¯è€ƒè™‘ Ellaã€‚`;
                }
            } else {
                rec.innerHTML = `åŸºäºå½“å‰å‚æ•°ï¼Œ<strong>Ella Cartridge</strong> æ›´å…·æˆæœ¬æ•ˆç›Šã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨äººå·¥æˆæœ¬æé«˜æˆ–æ ·æœ¬é‡å¾ˆå°çš„æƒ…å†µä¸‹ã€‚`;
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById('tab-' + tabName).classList.add('active');
        }

        function resetDefaults() {
            Object.keys(defaults).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = defaults[key];
                }
            });
            calculate();
        }

        // å®æ—¶è®¡ç®—ï¼ˆè¾“å…¥æ—¶è‡ªåŠ¨æ›´æ–°ï¼‰
        document.querySelectorAll('input, select').forEach(element => {
            element.addEventListener('input', function() {
                if (this.id !== 'hourlyRate' && this.id !== 'ellaReplicates') {
                    calculate();
                }
            });
        });
    </script>
</body>
</html>